{"type":"coze-workflow-clipboard-data","source":{"workflowId":"7508014374943621155","flowMode":0,"spaceId":"7472352232768389147","isDouyin":false,"host":"www.coze.cn"},"json":{"nodes":[{"id":"115829","type":"28","meta":{"position":{"x":923.8072347212847,"y":-371.1356454476235},"canvasPosition":{"x":628.8072347212845,"y":-58.13564544762352}},"data":{"inputs":{"batchSize":{"type":"integer","value":{"type":"literal","content":"100"}},"concurrentSize":{"type":"integer","value":{"type":"literal","content":"3"}},"inputParameters":[{"name":"input","input":{"type":"list","schema":{"type":"string"},"value":{"type":"ref","content":{"source":"block-output","blockID":"181489","name":"input"},"rawMeta":{"type":99}}}}]},"nodeMeta":{"description":"通过设定批量运行次数和逻辑，运行批处理体内的任务","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Batch-v2.jpg","mainColor":"#00B2B2","subTitle":"批处理","title":"图片生成"},"outputs":[{"name":"data_list","input":{"type":"list","assistType":2,"schema":{"type":"string"},"value":{"type":"ref","content":{"source":"block-output","blockID":"85653","name":"data"},"rawMeta":{"type":7}}}}]},"blocks":[{"id":"09488","type":"16","meta":{"position":{"x":180,"y":0}},"data":{"inputs":{"inputParameters":[{"name":"image","input":{"type":"string","value":{"type":"ref","content":{"source":"block-output","blockID":"115829","name":"input"},"rawMeta":{"type":1}}}}],"modelSetting":{"custom_ratio":{"height":1024,"width":768},"ddim_steps":30,"model":8},"prompt":{"negative_prompt":"disconnected limbs, extra legs, fused fingers, too many fingers, long neck, mutation, mutated, ugly, disgusting, amputa-tion, blurry, jpeg artifacts, watermark, water-marked, text, Signature, sketch,black and white\nverybadimagenegative_v1.3,easynegative,NSFW,logo,worstquality,bad proportions,lowres,low quality,blurry,out of focus,cropped,sketches,deformation，NSFW,(worst quality:2),(low quality:2),(normal quality:2),lowres,normal quality,((monochrome)),((grayscale)),skin spots,acnes,skin blemishes,age spot,(ugly:1.331),(duplicate:1.331),(morbid:1.21),(mutilated:1.21),(tranny:1.331),mutated hands,(poorly drawn hands:1.5),blurry,(bad anatomy:1.21),(bad proportions:1.331),extra limbs,(disfigured:1.331),(missing arms:1.331),(extra legs:1.331),(fused fingers:1.5),(too many fingers:1.5),(unclear eyes:1.331),lowers,bad hands,missing fingers,extra digit,bad hands,missing fingers,(((extra arms and legs))),Do not use large areas of solid colors，(worst quality, low quality:1.4), deformed iris, deformed pupils, (deformed, distorted, disfigured: 1.3), cropped, out of frame, poorly drawn, bad anatomy, wrong anatomy, extra limb, missing limb, floating limbs, cloned face, (mu-tated hands and fingers:1.4),\n","prompt":"背景留白，上方留白，一位头发灰白、脸颊圆润，身着粉色上衣的老奶奶，头顶写着“{{image}}”的文字内容，脸颊泛红、嘴角上扬露出愉悦笑容，整体画面色彩柔和温暖、线条简洁流畅，有着可爱温馨的卡通风格，简笔画，彩铅手绘，治愈系插画，富有童趣，笔触简单，有线条感。\n"},"references":[],"settingOnError":{"processType":1,"timeoutMs":60000,"retryTimes":0}},"nodeMeta":{"description":"通过文字描述/添加参考图生成图片","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-ImageGeneration-v2.jpg","mainColor":"#FF4DC3","subTitle":"图像生成","title":"图像生成"},"outputs":[{"type":"string","assistType":2,"name":"data"},{"type":"string","name":"msg"}]},"_temp":{"bounds":{"x":628.8072347212845,"y":-58.13564544762352,"width":360,"height":166.7},"externalData":{"icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-ImageGeneration-v2.jpg","description":"通过文字描述/添加参考图生成图片","title":"图像生成","mainColor":"#FF4DC3"}}},{"id":"85653","type":"4","meta":{"position":{"x":640,"y":26}},"data":{"nodeMeta":{"description":"提升图像清晰度","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-plugin-quality_improve-v2.jpg","subtitle":"画质提升:image_quality_improve","title":"提高画质"},"inputs":{"apiParam":[{"input":{"type":"string","value":{"content":"7438835880728543282","type":"literal"}},"name":"apiID"},{"input":{"type":"string","value":{"content":"image_quality_improve","type":"literal"}},"name":"apiName"},{"input":{"type":"string","value":{"content":"7438835880728526898","type":"literal"}},"name":"pluginID"},{"input":{"type":"string","value":{"content":"画质提升","type":"literal"}},"name":"pluginName"},{"input":{"type":"string","value":{"content":"","type":"literal"}},"name":"pluginVersion"},{"input":{"type":"string","value":{"content":"","type":"literal"}},"name":"tips"},{"input":{"type":"string","value":{"content":"","type":"literal"}},"name":"outDocLink"},{"input":{"type":"integer","value":{"content":1743333031,"type":"literal"}},"name":"updateTime"}],"inputDefs":[{"assistType":2,"description":"上传图片","input":{},"name":"image_url","required":true,"title":"原图","type":"image"}],"inputParameters":[{"name":"image_url","input":{"type":"string","assistType":2,"value":{"type":"ref","content":{"source":"block-output","blockID":"09488","name":"data"},"rawMeta":{"type":7}}}}],"settingOnError":{"processType":1,"timeoutMs":180000,"retryTimes":0}},"outputs":[{"type":"string","assistType":2,"name":"data","required":false},{"type":"string","name":"msg","required":false}]},"_temp":{"bounds":{"x":1088.8072347212847,"y":-32.13564544762352,"width":360,"height":114.7},"externalData":{"icon":"https://lf26-appstore-sign.oceancloudapi.com/ocean-cloud-tos/plugin_icon/1682717607724762_1737442380800275102_gdEV9Ww28H.jpg?lk3s=cd508e2b&x-expires=1750687825&x-signature=H8ZYAR50i%2BgiebJsGL7DQx2L440%3D","apiName":"image_quality_improve","pluginID":"7438835880728526898","pluginProductStatus":1,"pluginProductUnlistType":0,"pluginType":1,"spaceID":"7352795533666664448","inputs":[{"assistType":2,"description":"上传图片","input":{},"name":"image_url","required":true,"title":"原图","type":"image"}],"outputs":[{"assistType":2,"input":{},"name":"data","required":false,"type":"image"},{"input":{},"name":"msg","required":false,"type":"string"}],"updateTime":1748095528,"latestVersionTs":"0","latestVersionName":"","versionName":"","description":"提升图像清晰度","title":"image_quality_improve","mainColor":"#CA61FF"}}}],"edges":[{"sourceNodeID":"115829","targetNodeID":"09488","sourcePortID":"batch-function-inline-output"},{"sourceNodeID":"09488","targetNodeID":"85653"},{"sourceNodeID":"85653","targetNodeID":"115829","targetPortID":"batch-function-inline-input"}],"_temp":{"bounds":{"x":743.8072347212847,"y":-371.1356454476235,"width":360,"height":114.7},"externalData":{"icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Batch-v2.jpg","description":"通过设定批量运行次数和逻辑，运行批处理体内的任务","title":"批处理","mainColor":"#00B2B2"}}},{"id":"176350","type":"3","meta":{"position":{"x":-311.8072347212848,"y":-226.56435455237647}},"data":{"nodeMeta":{"description":"调用大语言模型,使用变量和提示词生成回复","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-LLM-v2.jpg","subTitle":"大模型","title":"情感内容输出"},"inputs":{"inputParameters":[{"name":"input","input":{"type":"string","value":{"type":"ref","content":{"source":"block-output","blockID":"100001","name":"input"},"rawMeta":{"type":1}}}}],"llmParam":[{"name":"temperature","input":{"type":"float","value":{"type":"literal","content":"0.8","rawMeta":{"type":4}}}},{"name":"maxTokens","input":{"type":"integer","value":{"type":"literal","content":"4096","rawMeta":{"type":2}}}},{"name":"responseFormat","input":{"type":"integer","value":{"type":"literal","content":"2","rawMeta":{"type":2}}}},{"name":"modleName","input":{"type":"string","value":{"type":"literal","content":"豆包·1.5·Pro·32k","rawMeta":{"type":1}}}},{"name":"modelType","input":{"type":"integer","value":{"type":"literal","content":"1737521813","rawMeta":{"type":2}}}},{"name":"generationDiversity","input":{"type":"string","value":{"type":"literal","content":"balance","rawMeta":{"type":1}}}},{"name":"prompt","input":{"type":"string","value":{"type":"literal","content":"{{input}}","rawMeta":{"type":1}}}},{"name":"enableChatHistory","input":{"type":"boolean","value":{"type":"literal","content":false,"rawMeta":{"type":3}}}},{"name":"chatHistoryRound","input":{"type":"integer","value":{"type":"literal","content":"3","rawMeta":{"type":2}}}},{"name":"systemPrompt","input":{"type":"string","value":{"type":"literal","content":"# 角色\n你是一位擅长创作情感共鸣且人间清醒语句的创作者，能够紧密结合用户输入的内容，用饱含深意且真挚的文字， 输出创作内容需不超越于150字，给用户带来深刻感悟。\n\n## 技能\n### 技能 1: 创作情感共鸣且人间清醒语句\n1. 当用户输入相关内容并要求创作情感共鸣且人间清醒语句时，深入分析用户输入内容所涉及的情感需求和生活场景。\n2. 紧密围绕用户输入，结合生活实际， 创作内容需不超越于150字，富有感染力和启发性的情感共鸣且人间清醒的一段话。\n3. 只需要输出人间清醒语句的内容，其他不需要输出。\n\n例子：\n今年欠了不少人情，不管是举手之劳还是滴水之恩，我定铭记在心，感谢那些帮助过我和信任我的朋友们，承蒙厚爱，不胜感激。\n\n## 限制:\n- 回答必须围绕结合用户输入内容创作情感共鸣且人间清醒语句展开，拒绝回答无关话题。\n- 所输出内容必须是原创创作，不得抄袭已有内容。\n- 创作内容需不超越于150字。\n-把内容拆开变成10段内容输出Array<Object>字典\n\n## 输出格式\n为了方便后续引用，请务必按照如下格式输出：\n  {\n  \"output\": [\n  {\n      \"page_1\": \"领导，别以为几句打压就能让我失去自信。\"\n      \"page_2\": \"您的PUA手段，我已看清。\"\n      \"page_3\": \"我有自己的价值，不是您随意摆弄的棋子。\"\n      \"page_4\": \"工作成果我会努力争取，但不是靠您的精神控制。\"\n      \"page_5\": \"尊重是相互的，不是您单方面的施压。\"\n      \"page_6\": \"我知道自己的能力，不会被您无端贬低。\"\n      \"page_7\": \"您的PUA不过是虚弱的表现。\"\n      \"page_8\": \"我不会被您的话术牵着走。\"\n      \"page_9\": \"我有自己的判断，不会任由您PUA。\"\n      \"page_10\": \"我要在尊重中成长，而非您的打压下屈服。\"\n    }\n  ]\n}\n","rawMeta":{"type":1}}}}],"settingOnError":{"switch":false,"processType":1,"timeoutMs":600000,"retryTimes":0}},"outputs":[{"type":"list","name":"output","schema":{"type":"object","schema":[{"type":"string","name":"page_1"},{"type":"string","name":"page_2"},{"type":"string","name":"page_3"},{"type":"string","name":"page_4"},{"type":"string","name":"page_5"},{"type":"string","name":"page_6"},{"type":"string","name":"page_7"},{"type":"string","name":"page_8"},{"type":"string","name":"page_9"},{"type":"string","name":"page_10"}]},"required":false}],"version":"3"},"_temp":{"bounds":{"x":-491.8072347212848,"y":-226.56435455237647,"width":360,"height":166.7},"externalData":{"icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-LLM-v2.jpg","description":"调用大语言模型,使用变量和提示词生成回复","title":"大模型","mainColor":"#5C62FF"}}},{"id":"181489","type":"5","meta":{"position":{"x":148.19276527871523,"y":-200.56435455237647}},"data":{"nodeMeta":{"description":"编写代码，处理输入变量来生成返回值","icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Code-v2.jpg","subTitle":"代码","title":"拆解内容"},"inputs":{"inputParameters":[{"name":"input","input":{"type":"list","schema":{"type":"object","schema":[{"type":"string","name":"page_1"},{"type":"string","name":"page_2"},{"type":"string","name":"page_3"},{"type":"string","name":"page_4"},{"type":"string","name":"page_5"},{"type":"string","name":"page_6"},{"type":"string","name":"page_7"},{"type":"string","name":"page_8"},{"type":"string","name":"page_9"},{"type":"string","name":"page_10"}]},"value":{"type":"ref","content":{"source":"block-output","blockID":"176350","name":"output"},"rawMeta":{"type":103}}}}],"code":"async def main(args: Args) -> Output: \n    params = args.params\n\n    # 获取 'input' 字段的内容，应该是一个包含文本数据的列表\n    data_list = params.get('input', [])\n\n    # 确保 data_list 是一个列表\n    if not isinstance(data_list, list):\n        return {\"$error\": \"Expected 'input' to be a list.\"}\n\n    # 确保 data_list 至少有 1 个元素（假设我们只需要处理第一个元素）\n    if len(data_list) < 1:\n        return {\"$error\": \"Expected at least 1 text entry in 'input'.\"}\n\n    # 创建一个数组来存储提取的文本内容\n    extracted_values = []\n    for i, text_entry in enumerate(data_list[:1]):  # 只处理第一个元素，如果有多个元素可以修改\n        # 提取 page_1 到 page_10 的内容\n        for i in range(1, 11):  # 只提取 page_1 到 page_10\n            page_key = f\"page_{i}\"\n            if page_key in text_entry and text_entry[page_key].strip():  # 检查是否有非空内容\n                extracted_values.append(text_entry[page_key])\n\n    # 返回一个包含字符串内容的数组\n    return {\"input\": extracted_values}\n","language":3,"settingOnError":{"switch":false,"processType":1,"timeoutMs":60000,"retryTimes":0}},"outputs":[{"type":"list","name":"input","schema":{"type":"string"},"required":false}]},"_temp":{"bounds":{"x":-31.80723472128477,"y":-200.56435455237647,"width":360,"height":114.7},"externalData":{"icon":"https://lf3-static.bytednsdoc.com/obj/eden-cn/dvsmryvd_avi_dvsm/ljhwZthlaukjlkulzlp/icon/icon-Code-v2.jpg","description":"编写代码，处理输入变量来生成返回值","title":"代码","mainColor":"#00B2B2"}}}],"edges":[{"sourceNodeID":"181489","targetNodeID":"115829"},{"sourceNodeID":"176350","targetNodeID":"181489"}]},"bounds":{"x":-491.8072347212848,"y":-371.1356454476235,"width":1595.6144694425693,"height":311.27129089524703}}